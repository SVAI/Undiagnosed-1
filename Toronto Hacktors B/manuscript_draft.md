# Undiagnosed-Toronto
Identifying putative causal variants in the noncoding genome

50% of genetic associations are located outside gene bodies; this fraction goes up to 80% if you include intronic regions. Therefore we hypothesized that genetic variants responsible for John’s ailments may be located in the noncoding genome. Our goal is to create a pipeline to evaluate variants by combining different sources of variant annotations. We hypothesised that causal variants in non-coding genome would be more challenging to analyze, so our emphasis has been on developing a tool focusing on non-coding variants. One of the greatest challenges for analyzing non-coding variants lies in efficient integration of various sources of information, most of which have been generated by various organizations with different goals and tools. Our tool will allow users to capture all these information and analyze variants simply providing a VCF file. 
## Methods
### Variant Annotation
#### Gut-specific regulatory regions
Chromatin states were downloaded for gut tissues from the NIH Roadmap Epigenomics Portal. The master file of all samples was downloaded from https://egg2.wustl.edu/roadmap/data/byFileType/chromhmmSegmentations/ChmmModels/coreMarks/jointModel/final/all.mnemonics.bedFiles.tgz
Chromatin states 1-7 were obtained for gut tissue samples: "E092" "E085" "E084" "E109" "E106" "E075" "E101" "E102" "E110" "E077" "E079" "E094"
#### Gut-specific regulation of gene expression
 Gut-specific variants that modulate transcrption (Gut eQTLs) were downloaded from the GTEx portal. Files included: Colon_Sigmoid.v7.signif_variant_gene_pairs.txt.gz" "Esophagus_Muscularis.v7.signif_variant_gene_pairs.txt.gz" "Colon_Transverse.v7.signif_variant_gene_pairs.txt.gz" "Small_Intestine_Terminal_Ileum.v7.signif_variant_gene_pairs.txt.gz" "Esophagus_Mucosa.v7.signif_variant_gene_pairs.txt.gz" "Stomach.v7.signif_variant_gene_pairs.txt.gz"
#### Genetic associations for gut diseases
The TargetValidation.org API was used to download GWAS associations for metabolic disorders (EFO:0000589). This website hosts GWAS hits from the NHGRI-EBI catalogue PMID: 30445434.

VCFtools was used to filter SNPs. bedtools2 was used to identify SNPs overlapping gut-specific promoters and enhancers (Roadmap Epigenomics) and gut eQTLs were obtained from GTEx. 


ClinVar 0 

## Tools and Datasets Used
Datasets
UCSC hg19 reference genome
UCSC dbSNP151

# Tools
* Pbmm2 index - Create indexed reference genome
* Pbmm2 align -  Align long reads
* Pbsv discover - Discover signatures of structural variation
* DeepVariant - Call SNVs
* SpliceAI - Deep learning based tool to identify splice variants (https://github.com/Illumina/SpliceAI)

## Aligning PacBio reads
`Pbmm2 align /root/notebooks/ReferenceGenome/hg19.fa 10kb_9pm.raw.bam 10kb_8pm.mapped.bam --sort --median-filter --sample sample1`

`Pbsv discover 10kb_9pm.mapped.bam 10kb_8pm.sample1.svsig.gz`

`Pbsv call hg19.fa 10kb_8pm.sample1.svsig.gz 10kb_8pm.var.vcf`

# Discussions
Even though there are a lot of data available databases available, there is no straightforward way to integrate them all. Each database contain pieces of information and many sources use different tools or formats, making the task of integration challenging. 

Below are several future directions that might be able to provide a lot of additional benefits to users.

Splice variant identification
Often splicing predictions are performed using databases of splicing variants, such as dbscSNV, or simple splice site prediction code, such as MaxEntScan which uses sequence motif and maximum entropy. This approach is limited by the quality of variant databases and simple splicing code can only make predictions only on canonical cases, limiting our ability to understand the impact of rare variants. Instead, In order to identify variant which can potentially result in aberrant splicing, SpliceAI, a deep learning model for predicting splice junctions from an arbitrary pre-mRNA transcript sequence, was used on variants called from DeepVariant on WGS. 
Variant Calling on Long Read Sequencing

Long read whole genome sequencing was generated using the PacBio’s single molecule real time (SMRT) sequencing. 

Reads were mapped to the hg19 human reference genome (http://hgdownload.soe.ucsc.edu/goldenPath/hg19/bigZips/hg19.fa.gz) using the pbmm2 long read aligner (https://github.com/PacificBiosciences/pbmm2). A deep neural network based DeepVariant was used for variant calling of both structural variants and single nucleotide variants. 

# Reference
* The Genome Sequencing Consortium. Initial sequencing and analysis of the human genome. Nature. 2001 Feb 15;409(6822):860-921.
